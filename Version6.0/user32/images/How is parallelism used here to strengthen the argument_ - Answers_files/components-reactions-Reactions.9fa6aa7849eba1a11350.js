"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[7465],{21692:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});var r=t(22122),o=t(96156),c=t(67294),i=t(28481),a=t(75315),u=t(84751),l=t(52301),s=t(8322),d=t(70399),f=t(59802),p=t(27157),v=t(90149),b=t(44740),m=t(94293),g=function(e){var n,t=e.emoji,r=e.id,o=e.objectId,g=e.auth,h=e.tooltip,y=e.objectType,O=void 0===y?"App\\Models\\Answer":y,j=(0,c.useState)(null!==(n=e.count)&&void 0!==n?n:0),_=(0,i.Z)(j,2),E=_[0],A=_[1],w=g.user?g.user.api_token:null,D=(0,c.useState)(!1),L=(0,i.Z)(D,2),N=L[0],P=L[1],S=O.lastIndexOf("\\"),I=O.substr(S+1),C=(0,u.I0)(),T=(0,a.Z)("/api/reaction/".concat(I,"/").concat(o,"/reaction/").concat(r)),Z=(0,f.Z)("can_react_anon",!0),k=(0,s.Ot)(E)[0].toString().length>=4,x="reaction_".concat(O,"_").concat(o,"_").concat(r),V=(0,u.v9)((function(e){var n,t,r,c;return null==e||null===(n=e.auth)||void 0===n||null===(t=n.user)||void 0===t||null===(r=t.reaction_record)||void 0===r||null===(c=r["App\\Models\\Answer"])||void 0===c?void 0:c[o]}));(0,c.useEffect)((function(){if((0,p.S_)()){var e,n=!1;if(V)n=null===(e=Object.values(V))||void 0===e?void 0:e.find((function(e){return e.id==r}));n?P(!0):(0,m.U2)(x).then((function(e){e&&(P(!0),A(E+1))})).catch((function(e){console.log("Failure to retrive reaction",e)}))}}),[]);var M=function(){fetch(T,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:w})}).then((function(e){return e.json()})).then((function(e){return e.errors?((0,m.t8)(x,1),A(E+1),console.log("Error: ",e.message),!1):(C(l.N.removeReaction(r,o,O)),!0)})).catch((function(e){return console.error("Error: ",e),(0,m.t8)(x,1),A(E+1),!1}))},R=function(){fetch(T,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:w})}).then((function(e){return e.json()})).then((function(e){return!e.errors||((0,m.IV)(x),A(E-1),console.log("Error: ",e.message),!1)})).catch((function(e){return console.error("Error: ",e),(0,m.IV)(x),A(E-1),!1}))};return c.createElement(v.Z,{tooltipName:h,tooltipClasses:"-mt-20 -ml-4"},c.createElement("div",{className:"".concat("\n        flex\n        flex-row\n        p-2\n        ml-1\n        rounded-md\n        items-center\n        text-center\n        border border-solid\n        bg-secondaryLight\n        mt-4\n    "," ").concat(N?"\n        border\n        border-solid\n        border-primaryColor\n        bg-primaryBG\n    ":"bg-secondaryLight border-primaryLight"," ").concat(k?"w-9":null),onClick:function(){if(!g.user&&!Z)return C(l.N.openModal("login")),void(0,d.qP)({eventCategory:"Answer Engagement",eventAction:"Reaction Attempted",eventLabel:h,eventValue:0});N?((0,b.VK)(o,h),(0,m.IV)(x),P(!1),A(E-1),g.loggedIn&&M()):((0,b.vY)(o,h),(0,m.t8)(x,1).then((function(){A(E+1),R(),P(!0)})))}},c.createElement("div",{className:"\n        reactionEmoji\n        leading-none\n    "},t),c.createElement("span",{className:"caption2"},E)))};function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var O=function(e){var n=e.recordedReactions,t=void 0===n?[]:n,o=e.objectType,i=void 0===o?"App\\Models\\Answer":o,a=e.objectId,l=(0,u.v9)((function(e){return e.auth})),s=Object.values((0,u.v9)((function(e){return e.pageData.content.avlReactions}))).map((function(e){var n=t.find((function(n){return n.reaction_id==e.id}));return void 0===n||"count"in n||(n.count=0),n?y(y({},e),n):e})).map((function(e,n){return c.createElement(g,(0,r.Z)({},e,{key:"".concat(e.id,"_").concat(t.length),objectId:a,objectType:i,auth:l,arrayPosition:n}))}));return c.createElement("div",{className:"flex ml-auto"},s)}}}]);